# Test the L language.

if {[lsearch [namespace children] ::tcltest] == -1} {
    package require tcltest 2
    namespace import -force ::tcltest::*
}

test proc-1.0 {Test L function definition.} -body {
#pragma language L
main(void) {
        puts("foo");
}
#pragma end
main  
} -output "foo\n"

test var-1.0 {Test L variable assignment and reference} -body {
#pragma language L
main(void)
{
	s = "Hello";
	puts(s);
}
#pragma end
main
} -output "Hello\n"

test pragma-1.0 {Test pragma parsing} -body {
# These are some Tcl Comments
#pragma language L
main(void)
{
	puts("worked");
}

#pragma end
# More comments
main
} -output "worked\n"

test pragma-2.0 {Test failure path in pragma parsing} -body {
#pragma language foo
main(void)
{
	puts("worked");
}

#pragma end
main
} -returnCodes {error} -result {unknown language}

test pragma-3.0 {Test lack of end pragma} -body {
#pragma language L
main(void)
{
	puts("worked");
}
} -returnCodes {error} -result {unfinished pragma}


# cleanup
::tcltest::cleanupTests
return
